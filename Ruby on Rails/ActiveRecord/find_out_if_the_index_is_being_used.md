## 該当クエリがindexを使用しているかどうか調べる

MySQL5.7だとIS NULLの検索では、indexがきちんと使えないようだったので、検証するためのもの

```ruby
user_scope = User.kept # 論理削除されていないuser（discarded_at: nilのものを探すクエリ）
puts User.connection.explain(user_scope.to_sql)
```

=> 

```
+----+-------------+------------+------------+------+----------------------------------+------+---------+------+------+----------+-------------+
| id | select_type | table      | partitions | type | possible_keys                    | key  | key_len | ref  | rows | filtered | Extra       |
+----+-------------+------------+------------+------+----------------------------------+------+---------+------+------+----------+-------------+
|  1 | SIMPLE      | users      | NULL       | ALL  | index_users_on_discarded_at      | NULL | NULL    | NULL |   52 |    100.0 | Using where |
+----+-------------+------------+------------+------+----------------------------------+------+---------+------+------+----------+-------------+
1 row in set (0.00 sec)
=> nil
```

type が `ALL`になっており、テーブルのフルスキャンが行われている模様。

ちなみに、indexが効いている場合？は

```ruby
user_scope = User.discarded # 論理削除されたuser（discarded_at: nilのものを探すクエリ）
puts User.connection.explain(user_scope.to_sql)
```

=>

```
+----+-------------+------------+------------+-------+----------------------------------+------------------------------+---------+------+------+----------+-----------------------+
| id | select_type | table      | partitions | type  | possible_keys                    | key                          | key_len | ref  | rows | filtered | Extra                 |
+----+-------------+------------+------------+-------+----------------------------------+------------------------------+---------+------+------+----------+-----------------------+
|  1 | SIMPLE      | users      | NULL       | range | index_users_on_discarded_at      | index_useers_on_discarded_at | 9       | NULL |    1 |    100.0 | Using index condition |
+----+-------------+------------+------------+-------+----------------------------------+------------------------------+---------+------+------+----------+-----------------------+
1 row in set (0.00 sec)
=> nil
```
